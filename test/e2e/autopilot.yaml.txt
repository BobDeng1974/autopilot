apiVersion: autopilot.examples.io/v1
kind: CanaryDeployment
operatorName: canary-operator
phases:

  - description: Creating deployments for the canary
    initial: true
    name: Initializing
    outputs:
      - deployments
      - services
      - virtualservices

  - description: Syncing the Canary with the Server
    inputs:
      - deployments
    name: Syncing

  - description: Waiting for the target deployment to be modified
    name: Waiting
    inputs:
      - deployments
    outputs:
      - deployments

  - description: Evaluating the canary
    inputs:
      - metrics
      - virtualservices
    name: Evaluating
    outputs:
      - virtualservices

  - description: Promoting the canary
    name: Promoting
    inputs:
      - deployments
      - virtualservices
    outputs:
      - deployments
      - virtualservices

  - description: Rolling back the canary
    name: RollBack
    inputs:
      - deployments
      - virtualservices
    outputs:
      - deployments
      - virtualservices
